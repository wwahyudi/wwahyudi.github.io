---
title:      How to Generate MFA Token like RSA SecurID Software Token on Ubuntu Linux?
date:       2021-03-31
summary:    How I can generate a MFA token like RSA SecurID Software Token on Ubuntu Linux
category:   Security
---

I write this post to create a Telegram chatbot that can generate a token for Check Point Mobile VPN.
Each time I need to login into a VPN account, I need to supply a token generated by RSA SecurID. The RSA SecurID Software Token is bound to a Device Serial Number on each installation on a specific device.
Since we only have one person have one token RSA SecurID registered. Each time we need to connect to VPN, we need to contact him to get VPN token access. So I like to have automated.

{% include image.html url="/images/2021-03-31-how-to-generate-mfa-token-like-rsa-securid-software-token-on-ubuntu-linux/check-point-client-which-need-to-supply-mfa-token-to-login.png" description="Check Point Client which need to supply MFA token to login" %}

I need to have how to generate MFA tokens like RSA SecurID Software Token in Linux. I tried to Google and [found that we can use](https://superuser.com/questions/353547/can-i-use-an-rsa-securid-software-token-on-ubuntu-linux) `stoken` to generate it.

`stoken` can be found in [Github](https://github.com/cernekee/stoken), or you can install on Ubuntu. You can install it with command:

```bash
sudo apt install stoken
```

After installed, import a token from a raw string or an "sdtid" XML file:

```bash
$ stoken import --file=tokenxml.sdtid --devid=4y7xxe00000y5z0xxx62
Enter new password:
Confirm new password:
```

In my case, I upload my sdtid XML file, and I need to supply the devid as Device ID or Device Serial Number as it is called on RSA SecurID Software Token.
You also need to supply a password, so that your seed is encrypted on disk, but in my case, I don't want a password, so I need to enter twice to create an empty password.

Next, use the CLI or GUI to show the current tokencode:

```bash
$ stoken tokencode
Enter password to decrypt token:
Enter PIN:
96235412
```

or if you not supply any password when import the "sdtid" XML file:

```bash
$ stoken tokencode --pin=0000
96235412
```

`stoken` also available in [Kevin Cernekee's Github](https://github.com/cernekee/stoken) and for manual can be found on [Ubuntu man page](http://manpages.ubuntu.com/manpages/xenial/man1/stoken.1.html).
